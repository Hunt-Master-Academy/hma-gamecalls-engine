╔══════════════════════════════════════════════════════════════════════════════════════════════════╗
║                        Huntmaster Audio Engine - Component Testing                              ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════╝

[0;34m[INFO][0m Component: audio
[0;34m[INFO][0m Verbose: true
[0;34m[INFO][0m Stress Test: false
[0;34m[INFO][0m Memory Check: false

[0;34m[INFO][0m Testing Audio I/O and Processing...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;36m[TEST][0m Audio file I/O and format handling
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[TestPaths] Initialized:
  Project root: "/mnt/e/develop/Huntmaster/huntmaster-engine"
  Data root: "/mnt/e/develop/Huntmaster/huntmaster-engine/data"
  Temp root: "/tmp/huntmaster_test_1753326794456"
=== DTW Debug Test ===
Validating inputs...
✅ Audio file found: data/master_calls/buck_grunt.wav
✅ Master call ID: buck_grunt
✅ Session created with ID: 1
Loading master call 'buck_grunt': SUCCESS
Loading audio file: data/master_calls/buck_grunt.wav
Audio info: 7488 samples, 22050Hz, 1 channels, 0.340s
⚠️  WARNING: Audio sample rate (22050Hz) doesn't match session (44100Hz)
This may cause feature extraction issues.

Testing chunk processing with 1024 samples:
  Processed 8 chunks, 7488 samples total
  Features extracted: 35
  Similarity score: 0.751321

Testing chunk processing with 512 samples:
  Processed 15 chunks, 7488 samples total
  Features extracted: 42
  Similarity score: 0.752571

Testing chunk processing with entire file:
  Processed 1 chunks, 7488 samples total
  Features extracted: 28
  Similarity score: 0.750227

Processing for main session...
Current master call: buck_grunt
Processing audio chunk (7488 samples): SUCCESS
Session feature count: 28
Similarity score: 0.750227

=== ANALYSIS ===
File: data/master_calls/buck_grunt.wav
Expected features: 42
Actual features: 28
Difference: -14

=== ADDITIONAL DIAGNOSTICS ===
Detailed scoring available:
  MFCC score: 1.000000
  Volume score: 0.501132
  Timing score: 0.500000
  Confidence: 0.000000
  Samples analyzed: 7488
  Is reliable: No
  Is match: Yes
Session duration: 0.091000 seconds
[0;32m[✓][0m Audio File Loading completed successfully (.149050713s)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;36m[TEST][0m Audio recording capabilities
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
=== Huntmaster Recording Test ===

Test 1: Testing recording capabilities...
Successfully loaded buck_grunt master call
Starting recording test...
ALSA lib confmisc.c:855:(parse_card) cannot find card '0'
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_card_inum returned error: No such file or directory
ALSA lib confmisc.c:422:(snd_func_concat) error evaluating strings
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_concat returned error: No such file or directory
ALSA lib confmisc.c:1342:(snd_func_refer) error evaluating name
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5727:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2721:(snd_pcm_open_noupdate) Unknown PCM default
ALSA lib confmisc.c:855:(parse_card) cannot find card '0'
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_card_id returned error: No such file or directory
ALSA lib confmisc.c:422:(snd_func_concat) error evaluating strings
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_concat returned error: No such file or directory
ALSA lib confmisc.c:1342:(snd_func_refer) error evaluating name
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5727:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2721:(snd_pcm_open_noupdate) Unknown PCM dsnoop
ALSA lib confmisc.c:855:(parse_card) cannot find card '0'
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_card_id returned error: No such file or directory
ALSA lib confmisc.c:422:(snd_func_concat) error evaluating strings
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_concat returned error: No such file or directory
ALSA lib confmisc.c:1342:(snd_func_refer) error evaluating name
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5727:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2721:(snd_pcm_open_noupdate) Unknown PCM dsnoop:0
ALSA lib confmisc.c:855:(parse_card) cannot find card '0'
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_card_id returned error: No such file or directory
ALSA lib confmisc.c:422:(snd_func_concat) error evaluating strings
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_concat returned error: No such file or directory
ALSA lib confmisc.c:1342:(snd_func_refer) error evaluating name
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5727:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2721:(snd_pcm_open_noupdate) Unknown PCM dsnoop:0,0
ALSA lib confmisc.c:165:(snd_config_get_card) Cannot get card index for 0
ALSA lib confmisc.c:165:(snd_config_get_card) Cannot get card index for 0
ALSA lib confmisc.c:165:(snd_config_get_card) Cannot get card index for 0
Recording started at 44100 Hz
✓ Recording started successfully
✓ Recording status confirmed
Recording for 2 seconds with level monitoring...
Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00Level: [                                                  ] 0.00
Recording stopped. Captured 2.00 seconds.
✓ Recording stopped successfully
✓ Recording duration: 2.00 seconds
Failed to create WAV file: ../data/recordings/test_recording.wav
✗ Failed to save recording

Test 2: Testing audio processing...
✓ Successfully processed test audio chunk
✓ Got similarity score: 0.21

Test 3: Testing playback capabilities...
AudioPlayer Error: Failed to load file ../data/recordings/test_recording.wav
Note: Could not play back recording (file may not exist)

Recording and playback tests completed!
[0;32m[✓][0m Audio Recording Test completed successfully (2.056707180s)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;36m[TEST][0m Cross-platform audio compatibility
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
=== Cross-Platform Consistency Tests ===
Ensuring identical results across different scenarios

=== Generating Test Vectors ===

Generating vector for: Sine Wave 440Hz

Generating vector for: Complex Wave

=== Verifying Processing Consistency ===

Test 1: Batch vs Chunk Processing
---------------------------------
  Batch processing score: 0.25022650
  Chunk processing score: 0.28244746
  Score difference: 0.03222096
  Status: FAIL ✗

Test 2: Different Chunk Sizes
-----------------------------
  Chunk size 256: Score = 0.30426055
  Chunk size 512: Score = 0.28244746
  Chunk size 1024: Score = 0.26790294
  Chunk size 2048: Score = 0.25949493
  Max score difference: 0.04476562
  Status: FAIL ✗

=== Testing Edge Cases ===

Test 1: Empty Audio
-------------------
  Empty audio score: 0.00000000
  Status: PASS ✓

Test 2: Very Short Audio (100 samples)
--------------------------------------
  Short audio score: 0.00000000
  Status: PASS ✓ (No crash)

Test 3: Complete Silence
------------------------
  Silence score: 0.00000000
  Status: PASS ✓ (Handled gracefully)

Test 4: Clipped Audio
---------------------
  Clipped audio score: 0.00000000
  Status: PASS ✓ (Processed without crash)

=== Testing Different Sample Rates ===

Testing 16000.00000000 Hz:
  Score: 0.00000000
  Status: PASS ✓

Testing 22050.00000000 Hz:
  Score: 0.00000000
  Status: PASS ✓

Testing 44100.00000000 Hz:
  Score: 0.00000000
  Status: PASS ✓

Testing 48000.00000000 Hz:
  Score: 0.00000000
  Status: PASS ✓


=== TEST SUMMARY ===
Processing Consistency: FAIL ✗
Edge Cases: PASS ✓
Sample Rates: PASS ✓

Overall: SOME TESTS FAILED ✗

Cross-platform tests completed.
